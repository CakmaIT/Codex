<Window x:Class="Ozge.App.Presentation.Windows.ProjectorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModels="clr-namespace:Ozge.App.Presentation.ViewModels"
        mc:Ignorable="d"
        Title="Ozge2 - Projector"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource ProjectorBackgroundBrush}">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </Window.Resources>

    <Window.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <BeginStoryboard>
                <Storyboard RepeatBehavior="Forever" AutoReverse="True">
                    <DoubleAnimation Storyboard.TargetName="GlowBubbleOneTransform"
                                     Storyboard.TargetProperty="X"
                                     Duration="0:0:22"
                                     From="0"
                                     To="42" />
                    <DoubleAnimation Storyboard.TargetName="GlowBubbleTwoTransform"
                                     Storyboard.TargetProperty="Y"
                                     Duration="0:0:26"
                                     From="0"
                                     To="-36" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers>

    <Grid>
        <Grid>
            <Rectangle Fill="{StaticResource ProjectorBackgroundBrush}" />
            <Ellipse Width="480"
                     Height="480"
                     Fill="#33FFFFFF"
                     Opacity="0.28"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top"
                     Margin="-160,-160,0,0">
                <Ellipse.RenderTransform>
                    <TranslateTransform x:Name="GlowBubbleOneTransform" />
                </Ellipse.RenderTransform>
            </Ellipse>
            <Ellipse Width="360"
                     Height="360"
                     Fill="#22FFFFFF"
                     Opacity="0.22"
                     HorizontalAlignment="Right"
                     VerticalAlignment="Bottom"
                     Margin="0,0,-140,-160">
                <Ellipse.RenderTransform>
                    <TranslateTransform x:Name="GlowBubbleTwoTransform" />
                </Ellipse.RenderTransform>
            </Ellipse>
        </Grid>

        <Grid Margin="36">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <TextBlock Text="{Binding ModeTitle}"
                       FontSize="56"
                       FontWeight="Black"
                       Foreground="White"
                       TextOptions.TextFormattingMode="Display" />

            <Border Grid.Row="1"
                    Margin="0,28,0,0"
                    Background="#22FFFFFF"
                    BorderBrush="#55FFFFFF"
                    BorderThickness="2"
                    CornerRadius="28"
                    Padding="28">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="{Binding Prompt}"
                               FontSize="42"
                               FontWeight="Bold"
                               TextAlignment="Center"
                               TextWrapping="Wrap" />
                    <TextBlock Text="{Binding Feedback}"
                               FontSize="28"
                               Margin="0,22,0,0"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               Foreground="{StaticResource ProjectorAccentBrush}" />
                </StackPanel>
            </Border>

            <Border Grid.Row="2"
                    Background="#1CFFFFFF"
                    BorderBrush="#60FFFFFF"
                    BorderThickness="2"
                    CornerRadius="32"
                    Padding="28"
                    Margin="0,36,0,0"
                    Visibility="{Binding IsQuizVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Row="0"
                               LastChildFill="False">
                        <TextBlock Text="{Binding QuizPrompt}"
                                   DockPanel.Dock="Left"
                                   FontSize="40"
                                   FontWeight="Black"
                                   TextWrapping="Wrap"
                                   MaxWidth="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=Border}}"
                                   HorizontalAlignment="Stretch" />
                        <StackPanel DockPanel.Dock="Right"
                                    HorizontalAlignment="Right">
                            <TextBlock Text="{Binding QuizProgress}"
                                       FontSize="30"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource ProjectorAccentBrush}"
                                       HorizontalAlignment="Right" />
                            <TextBlock Text="{Binding QuizProgressDetail}"
                                       FontSize="24"
                                       HorizontalAlignment="Right"
                                       Opacity="0.9" />
                        </StackPanel>
                    </DockPanel>

                    <ProgressBar Grid.Row="1"
                                 Minimum="0"
                                 Maximum="1"
                                 Height="16"
                                 Margin="0,22,0,16"
                                 Value="{Binding QuizProgressValue}">
                        <ProgressBar.Resources>
                            <SolidColorBrush x:Key="ProgressBarForeground" Color="#FFFFEA7A" />
                            <SolidColorBrush x:Key="ProgressBarBackground" Color="#22FFFFFF" />
                        </ProgressBar.Resources>
                    </ProgressBar>

                    <ScrollViewer Grid.Row="2"
                                  Margin="0,12,0,0"
                                  VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding QuizOptions}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate DataType="{x:Type viewModels:ProjectorQuizOptionViewModel}">
                                    <Border CornerRadius="20"
                                            Padding="20"
                                            Margin="0,10"
                                            Background="{StaticResource OptionBrushA}">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="{StaticResource OptionBrushA}" />
                                                <Setter Property="Opacity" Value="0.95" />
                                                <Setter Property="BorderBrush" Value="#22FFFFFF" />
                                                <Setter Property="BorderThickness" Value="2" />
                                                <Setter Property="Effect">
                                                    <Setter.Value>
                                                        <DropShadowEffect BlurRadius="16"
                                                                          ShadowDepth="0"
                                                                          Opacity="0.35" />
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Position}" Value="1">
                                                        <Setter Property="Background" Value="{StaticResource OptionBrushB}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Position}" Value="2">
                                                        <Setter Property="Background" Value="{StaticResource OptionBrushC}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Position}" Value="3">
                                                        <Setter Property="Background" Value="{StaticResource OptionBrushD}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Position}" Value="4">
                                                        <Setter Property="Background" Value="{StaticResource OptionBrushE}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding IsHighlighted}" Value="True">
                                                        <Setter Property="BorderBrush" Value="White" />
                                                        <Setter Property="Effect">
                                                            <Setter.Value>
                                                                <DropShadowEffect BlurRadius="30"
                                                                                  ShadowDepth="0"
                                                                                  Color="#FFFFFFFF"
                                                                                  Opacity="0.85" />
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <Border Grid.Column="0"
                                                    Width="48"
                                                    Height="48"
                                                    CornerRadius="24"
                                                    Margin="0,0,16,0"
                                                    Background="#33FFFFFF"
                                                    BorderBrush="#55FFFFFF"
                                                    BorderThickness="2">
                                                <TextBlock Text="{Binding Label}"
                                                           FontSize="28"
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />
                                            </Border>

                                            <TextBlock Grid.Column="1"
                                                       Text="{Binding Text}"
                                                       FontSize="32"
                                                       FontWeight="SemiBold"
                                                       TextWrapping="Wrap"
                                                       VerticalAlignment="Center" />

                                            <TextBlock Grid.Column="2"
                                                       Text="✔"
                                                       FontSize="34"
                                                       FontWeight="Bold"
                                                       Margin="16,0,0,0"
                                                       Foreground="White"
                                                       VerticalAlignment="Center"
                                                       MinWidth="48">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Visibility" Value="Hidden" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsHighlighted}" Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <Grid x:Name="FreezeOverlay"
              Background="#B3001F3F"
              Visibility="Collapsed">
            <TextBlock Text="Ekran Donduruldu"
                       FontSize="68"
                       FontWeight="Black"
                       Foreground="White"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center" />
        </Grid>

        <Grid x:Name="AnswerOverlay"
              Background="Transparent"
              Visibility="Collapsed">
            <TextBlock Text="Cevaplar Açık"
                       FontSize="50"
                       FontWeight="Bold"
                       Foreground="White"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Bottom"
                       Margin="0,0,24,24" />
        </Grid>

        <Grid x:Name="CelebrationOverlay"
              Visibility="{Binding ShowCelebration, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        RenderTransformOrigin="0.5,0.5">
                <StackPanel.RenderTransform>
                    <ScaleTransform x:Name="CelebrationScale" />
                </StackPanel.RenderTransform>
                <StackPanel.Style>
                    <Style TargetType="StackPanel">
                        <Setter Property="Opacity" Value="0" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ShowCelebration}" Value="True">
                                <Setter Property="Opacity" Value="1" />
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX"
                                                             From="0.9"
                                                             To="1.05"
                                                             Duration="0:0:2"
                                                             AutoReverse="True" />
                                            <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY"
                                                             From="0.9"
                                                             To="1.05"
                                                             Duration="0:0:2"
                                                             AutoReverse="True" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>
                <TextBlock Text="Harika İş!"
                           FontSize="80"
                           FontWeight="Black"
                           Foreground="White"
                           TextAlignment="Center" />
                <TextBlock Text="Bir sonraki tur için alkış!"
                           FontSize="36"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource ProjectorAccentBrush}"
                           TextAlignment="Center"
                           Margin="0,12,0,0" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>
